<<<<<<< HEAD
'use strict';
=======
>>>>>>> feature

/**
 * Module dependencies.
 */

<<<<<<< HEAD
const typeis = require('type-is');
const json = require('./json');
const form = require('./form');
const text = require('./text');

const jsonTypes = [ 'json', 'application/*+json', 'application/csp-report' ];
const formTypes = [ 'urlencoded' ];
const textTypes = [ 'text' ];
=======
var typeis = require('type-is');
var json = require('./json');
var form = require('./form');
var text = require('./text');

var jsonTypes = ['json', 'application/*+json', 'application/csp-report'];
var formTypes = ['urlencoded'];
var textTypes = ['text'];
>>>>>>> feature

/**
 * Return a Promise which parses form and json requests
 * depending on the Content-Type.
 *
 * Pass a node request or an object with `.req`,
 * such as a koa Context.
 *
 * @param {Request} req
 * @param {Options} [opts]
 * @return {Function}
 * @api public
 */

<<<<<<< HEAD
module.exports = async function(req, opts) {
=======
module.exports = function(req, opts){
>>>>>>> feature
  req = req.req || req;
  opts = opts || {};

  // json
<<<<<<< HEAD
  const jsonType = opts.jsonTypes || jsonTypes;
  if (typeis(req, jsonType)) return json(req, opts);

  // form
  const formType = opts.formTypes || formTypes;
  if (typeis(req, formType)) return form(req, opts);

  // text
  const textType = opts.textTypes || textTypes;
  if (typeis(req, textType)) return text(req, opts);

  // invalid
  const type = req.headers['content-type'] || '';
  const message = type ? 'Unsupported content-type: ' + type : 'Missing content-type';
  const err = new Error(message);
  err.status = 415;
  throw err;
=======
  var jsonType = opts.jsonTypes || jsonTypes;
  if (typeis(req, jsonType)) return json(req, opts);

  // form
  var formType = opts.formTypes || formTypes;
  if (typeis(req, formType)) return form(req, opts);

  // text
  var textType = opts.textTypes || textTypes;
  if (typeis(req, textType)) return text(req, opts);

  // invalid
  var type = req.headers['content-type'] || '';
  var message = type ? 'Unsupported content-type: ' + type : 'Missing content-type';
  var err = new Error(message);
  err.status = 415;
  return Promise.reject(err);
>>>>>>> feature
};
